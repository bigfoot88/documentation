============================
如何导入数据到 Odoo
============================

如何开始
--------

您可以使用 Excel (.xlsx) 或 CSV (.csv) 格式将数据导入到任何 Odoo 的业务对象中：联系人、产品、银行对账单、会计分录甚至订单！

打开您要填充的对象视图，然后点击 *导入*。

.. image:: media/import_button.png
    :align: center

在此页面，您将获得可以轻松填充您自己数据的模板。这些模板可以一键导入；数据映射已经完成。

如何调整模板
--------------

* 添加、删除和排序列以最适合您的数据结构。
* 我们建议不要删除 **ID** 列（详见下一节原因）。
* 通过向下拖动 ID 序列为每条记录设置唯一 ID。

.. image:: media/dragdown.gif
    :align: center

* 当您添加新列时，如果标签不符合 Odoo 中的任何字段，Odoo 可能无法自动映射它。不要担心！您可以在测试导入时手动映射新列。在列表中搜索相应字段。

    .. image:: media/field_list.png
        :align: center

  然后，在您的文件中使用该字段的标签，以便下次可以直接使用。

如何从其他应用程序导入
--------------------------

为了重新创建不同记录之间的关系，您应该使用原始应用程序中的唯一标识符并将其映射到 Odoo 中的 **ID** (外部 ID) 列。当您导入链接到第一个记录的另一个记录时，使用 **XXX/ID** (XXX/外部 ID) 对应原始唯一标识符。您也可以使用其名称找到此记录，但如果至少有两个记录具有相同名称，您将无法继续。

**ID** 还将用于在以后需要重新导入修改后的数据时更新原始导入，因此尽可能指定它是一个好习惯。

找不到要映射的字段
----------------------

Odoo 基于文件的前十行尝试找到每列的字段类型。例如，如果您有一列只包含数字，则只会显示整数类型的字段供您选择。虽然这种行为在大多数情况下很好且容易，但也有可能出错，或者您希望将列映射到默认未提议的字段。

如果发生这种情况，您只需选中 **显示关系字段的所有字段（高级）** 选项，然后您将能够为每列选择完整字段列表。

.. image:: media/field_list.png
  :align: center

如何更改日期导入格式
------------------------

Odoo 可以自动检测列是否为日期，并尝试从最常用的日期格式集中猜测日期格式。虽然此过程适用于许多日期格式，但某些日期格式无法识别。这可能会由于日月颠倒而引起混淆；例如在 '01-03-2016' 这样的日期格式中，很难猜测哪个部分是日期，哪个部分是月份。

要查看 Odoo 从文件中找到的日期格式，您可以点击文件选择器下的 **选项** 查看 **日期格式**。如果此格式不正确，您可以使用 *ISO 8601* 定义格式进行更改。

.. note::
    如果您正在导入 Excel (.xls, .xlsx) 文件，可以使用日期单元格存储日期，因为 Excel 中日期的显示方式与存储方式不同。这样，无论您的本地日期格式如何，您都可以确保 Odoo 中的日期格式正确。

能否导入带货币符号的数字（例如：$32.00）？
------------------------------------------

可以，我们完全支持使用括号表示负号的数字以及带货币符号的数字。Odoo 还会自动检测您使用的千位分隔符和小数点分隔符（可以在 **选项** 中更改这些设置）。如果您使用的货币符号 Odoo 不识别，可能无法将其识别为数字并导致导入失败。

支持的数字示例（以三万二千为例）：

- 32.000,00
- 32000,00
- 32,000.00
- -32000.00
- (32000.00)
- $ 32.000,00
- (32000.00 €)

不支持的示例：

- ABC 32.000,00
- $ (32.000,00)

导入预览表格显示不正确时该怎么办？
------------------------------------------

默认情况下，导入预览设置为逗号作为字段分隔符，双引号作为文本定界符。如果您的 CSV 文件没有这些设置，可以在选择文件后在 CSV 文件栏下的文件格式选项中进行修改。

请注意，如果您的 CSV 文件以制表符作为分隔符，Odoo 将无法检测到分隔符。您需要在电子表格应用程序中更改文件格式选项。请参见下一个问题。

如何在电子表格应用程序中保存 CSV 文件时更改文件格式选项？
-------------------------------------------

如果您在电子表格应用程序中编辑并保存 CSV 文件，计算机的区域设置将应用于分隔符和定界符。我们建议您使用 OpenOffice 或 LibreOffice Calc，因为它们允许您修改所有三个选项（在“另存为”对话框中 > 勾选“编辑过滤器设置” > 保存）。

Microsoft Excel 只允许您在保存时修改编码（在“另存为”对话框中 > 点击“工具”下拉列表 > 编码选项卡）。

数据库 ID 和外部 ID 有什么区别？
------------------------------------

有些字段定义了与另一个对象的关系。例如，联系人的国家/地区是指向“国家/地区”对象记录的链接。当您想要导入此类字段时，Odoo 必须重新创建不同记录之间的链接。为帮助您导入此类字段，Odoo 提供了 3 种机制。对于要导入的每个字段，您必须使用一种且仅使用一种机制。

例如，要引用联系人的国家/地区，Odoo 提供了 3 种不同的字段进行导入：

- 国家/地区：国家/地区的名称或代码
- 国家/地区/数据库 ID：记录的唯一 Odoo ID，由 ID postgresql 列定义
- 国家/地区/外部 ID：在另一个应用程序中引用此记录的 ID（或导入它的 .XML 文件）

对于比利时国家/地区，您可以使用这 3 种方式之一进行导入：

- 国家/地区：比利时
- 国家/地区/数据库 ID：21
- 国家/地区/外部 ID：base.be

根据您的需要，您应该使用其中一种方式来引用关系中的记录。以下是根据需要使用其中一种方式的情况：

- 使用国家/地区：当您的数据来自手动创建的 CSV 文件时，这是最简单的方式。
- 使用国家/地区/数据库 ID：您应尽量少使用这种方式。它主要被开发人员使用，其主要优点是永远不会发生冲突（您可能有多个具有相同名称的记录，但它们总是具有唯一的数据库 ID）。
- 使用国家/地区/外部 ID：当您从第三方应用程序导入数据时，使用外部 ID。

使用外部 ID 时，可以导入包含“外部 ID”列的 CSV 文件，以定义您导入的每个记录的外部 ID。然后，您可以使用类似“字段/外部 ID”的列引用该记录。以下两个 CSV 文件为产品及其类别提供了一个示例。

:download:`CSV 文件的类别
<files/External_id_3rd_party_application_product_categories.csv>`.

:download:`CSV 文件的产品
<files/External_id_3rd_party_application_products.csv>`.

如果字段有多个匹配项怎么办？
-------------------------------

例如，如果您有两个子名称为“可销售”的产品类别（即“杂项产品/可销售”和“其他产品/可销售”），您的验证将被中止，但您仍可以导入数据。然而，我们建议您不要导入数据，因为它们将全部链接到产品类别列表中的第一个“可销售”类别（“杂项产品/可销售”）。我们建议您修改其中一个重复值或产品类别层次结构。

但是，如果您不希望更改产品类别的配置，我们建议您使用外部 ID 对此字段“类别”进行处理。

如何导入多对多关系字段（例如拥有多个标签的客户）？
-------------------------------------------

标签应以逗号分隔且没有空格。例如，如果您希望客户与“制造商”和“零售商”这两个标签相关联，那么您应该在 CSV 文件的同一列中编码“制造商，零售商”。

:download:`制造商和零售商的 CSV 文件 <files/m2m_customers_tags.csv>`

如何导入一对多关系（例如销售订单的多个订单行）？
-------------------------------------------

如果要导入包含多个订单行的销售订单；对于每个订单行，您需要在 CSV 文件中保留特定的行。
第一条订单行将导入到与订单相关信息相同的行。
任何额外的行都需要一个不包含订单相关字段信息的额外行。
例如，这里有一些可以导入的报价的 CSV 文件，基于演示数据。

