==========================================================
如何创建包含自定义公式的报告？
==========================================================

概述
========

Odoo 12 提供了一个功能强大且易于使用的报表框架。创建新的报表（例如税务报告、特定分组和布局的资产负债表或损益表）以满足您的需求，现在比以往更简单。

启用开发者模式
===========================

为了访问财务报表创建界面，需要启用 **开发者模式**。要做到这一点，首先点击右上角菜单中的用户头像，然后点击 **关于**。

.. image:: media/customize01.png
   :align: center

点击： **启用开发者模式**。

.. image:: media/customize03.png
   :align: center

创建您的财务报表
============================

首先，您需要创建您的财务报表。要做到这一点，请进入
:menuselection:`会计 --> 配置 --> 财务报表`

.. image:: media/customize02.png
   :align: center

输入名称后，还有两个其他参数需要配置：

- **显示借方和贷方列**

- **分析期间**：

   - 基于日期范围（例如损益表）

   - 基于单个日期（例如资产负债表）

   - 基于日期范围且带有“较早”和“总计”列以及最近3个月（例如应付账款余额）

   - 基于日期范围和现金基础方法（例如现金流量表）

在自定义报告中添加行
=================================

创建报表后，您需要为其填充行。它们都需要一个 **名称**、一个 **代码**（用于引用该行）、一个 **序号** 和一个 **级别**（用于行渲染）。

.. image:: media/customize04.png
   :align: center

在 **公式** 字段中，您可以添加一个或多个公式以为余额列（如果适用，还包括借方和贷方列）分配值，用 **;** 分隔。

您在公式中可以使用的对象有：

- ``Ndays``：选定期间的天数（对于有日期范围的报表）。

- 另一个报告，通过其代码引用。使用 ``.balance`` 获取其余额值（还可用的有 ``.credit``、``.debit`` 和 ``.amount_residual``）。

一行也可以基于选定域内的账户分录行的总和。在这种情况下，您需要在域字段中填写一个 Odoo 账户分录行对象的域。然后在公式字段中将有一个额外的对象，即 ``sum``，即域内账户分录行的总和。您还可以使用分组字段按其列之一对账户分录行进行分组。

其他有用的字段：

- **类型**：公式结果的类型。

- **正增长是否良好**：计算比较列时使用。检查增长是否良好（以绿色显示）或否。

- **特殊日期更改器**：如果报表中的特定行不应使用与报表其余部分相同的日期。

- **显示域**：行的域如何显示。可以是可折叠的（``默认``，开始时隐藏但可以展开），``始终``（始终显示）或``从不``（从不显示）。

.. seealso::
    * :doc:`main_reports`
